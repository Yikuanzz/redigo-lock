# RedLock 示例 🔒

这个示例展示了如何使用 RedLock 算法来实现更强一致性的分布式锁。

## 前置条件 ⚙️

- Go 1.24 或更高版本
- Docker 和 Docker Compose
- 确保本地端口 6379-6383 未被占用

## 快速开始 🚀

1. 启动 Redis 实例：

```bash
docker-compose up -d
```

2. 运行示例代码：

```bash
go run redlock_example.go
```

## 示例说明 📝

这个示例演示了：

- 如何使用多个 Redis 实例实现 RedLock
- 如何配置看门狗自动续期
- 如何手动刷新锁
- 如何优雅地释放锁

## RedLock 算法说明 🔍

RedLock 算法通过以下步骤实现分布式锁：

1. 获取当前时间（毫秒）
2. 按顺序向 N 个 Redis 实例获取锁
3. 计算获取锁消耗的时间
4. 当且仅当满足以下条件时，认为获取锁成功：
   - 成功获取超过 N/2+1 个实例的锁
   - 获取锁消耗的总时间小于锁的有效时间

## 注意事项 ⚠️

1. 确保所有 Redis 实例的时钟同步
2. 合理设置锁的过期时间
3. 使用 defer 确保锁的释放
4. 建议开启看门狗自动续期

## 清理 🧹

运行完示例后，可以使用以下命令清理 Redis 实例：

```bash
docker-compose down -v
``` 